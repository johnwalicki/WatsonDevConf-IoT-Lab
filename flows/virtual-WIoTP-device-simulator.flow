[{"id":"c757da5.fb976a8","type":"start virtual device","z":"afc892bb.1a7a58","name":"Configure device type and ID","deviceId":"thermostat343","schema":"72ecec5c.3f1d0c","outputs":1,"x":520,"y":180,"wires":[["2046173.6d37c68","31cc0358.939584","8f1d0ac0.d43f88"]]},{"id":"43d4bb1c.6bb51c","type":"generate event","z":"afc892bb.1a7a58","deviceId":"thermostat343","schema":"72ecec5c.3f1d0c","evt":"27c1bb4a69ea","name":"Event generator","x":620,"y":380,"wires":[["1539ad74.1105cb"]]},{"id":"e991dffe.eed12","type":"inject","z":"afc892bb.1a7a58","name":"1. Register device and device type","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":true,"x":210,"y":180,"wires":[["c757da5.fb976a8"]]},{"id":"31cc0358.939584","type":"device-type-manager","z":"afc892bb.1a7a58","auth":"bluemix","name":"Register type","apiKey":"","deviceType":"","classId":"Device","method":"Create","deviceTypeId":"","serialNumber":"","manufacturer":"","model":"","deviceClass":"","infoDescription":"","firmwareVersion":"","hardwareVersion":"","descriptiveLocation":"","metadata":"","password":"","properties":[],"ignore":true,"x":860,"y":120,"wires":[["8f1d0ac0.d43f88"]]},{"id":"6c3e063c.695f38","type":"device-manager","z":"afc892bb.1a7a58","auth":"bluemix","name":"Register device","apiKey":"","deviceType":"thermostat","method":"Create","deviceId":"","password":"","ignore":true,"x":940,"y":240,"wires":[["8f1d0ac0.d43f88"]]},{"id":"77edccf6.aa7c0c","type":"device function","z":"afc892bb.1a7a58","deviceId":"thermostat343","schema":"72ecec5c.3f1d0c","name":"Virtual device logic","func":"// Random Number Generator\nvar getRandomIntInclusive = function (min, max,fixed) {\n  return (Math.random() * (max - min + 1) + min).toFixed(fixed) ;\n}\n\n// Generate temp and humidity for the device event.\ntemp = getRandomIntInclusive(27, 45, 1);// Deg C\n\nhumidity = getRandomIntInclusive(50, 75, 1); // %\n\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":380,"wires":[["43d4bb1c.6bb51c"]]},{"id":"e04dedb0.f5c1c","type":"ibmiot out","z":"afc892bb.1a7a58","authentication":"boundService","apiKey":"","outputType":"evt","deviceId":"mydeviceid","deviceType":"mytype","eventCommandType":"myevent","format":"json","data":"{\"temp\":43}","qos":"","name":"Publish event","service":"registered","x":980,"y":380,"wires":[]},{"id":"ecc9ebee.57641","type":"comment","z":"afc892bb.1a7a58","name":"Device Simulator Using Virtual Device Nodes connecting to Watson IoT Platform","info":"In this flow, the Virtual Device nodes are used \nto simulate the device behaviour. \n\n* The \"1. Register device and device type\" inject\nnode is used to initialize the virtual device \nstart the register device flow.\n\n* The \"2. Publish device event\" inject node is\nused to simulate the publication of an event by\nthe virtual device.\n\n* The \"Temperature Monitor\" subflow listens for\nevents and analyses the data.","x":640,"y":80,"wires":[]},{"id":"f7c2f8ea.9e6078","type":"comment","z":"afc892bb.1a7a58","name":"Press to Publish an Event to Watson IoT Platform","info":"\"Virtual Device Logic\" has the logic to simulate the Temperature and Humidity.\n\n","x":220,"y":340,"wires":[]},{"id":"2046173.6d37c68","type":"delay","z":"afc892bb.1a7a58","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":760,"y":240,"wires":[["6c3e063c.695f38"]]},{"id":"8f1d0ac0.d43f88","type":"debug","z":"afc892bb.1a7a58","name":"","active":false,"console":"false","complete":"true","x":1130,"y":180,"wires":[]},{"id":"524f3d2b.c7cd04","type":"inject","z":"afc892bb.1a7a58","name":"2. Publish device event","topic":"","payload":"","payloadType":"date","repeat":"1","crontab":"","once":false,"x":170,"y":380,"wires":[["77edccf6.aa7c0c"]]},{"id":"22f2830f.4217a4","type":"comment","z":"afc892bb.1a7a58","name":"Tips","info":"If you want to continuously send events to the IBM \nWatson IoT, then edit the \"Publish Device Event\"\nnode and set an interval to inject.\n\nAfter you deploy your changes, you will need to \ninitialize the simulator. So you will have to \npress \"1. Register and Initialize the device\" again.","x":122.46429443359375,"y":428.8691101074219,"wires":[]},{"id":"4808d907.7b9358","type":"comment","z":"afc892bb.1a7a58","name":"Press to create device type 'thermostat' and register device 'themostat01'","info":"This flow does the following  \n1. Creates a device type **thermostat** if it does not exist\n2. Registers a device instance **thermostat01**\n\nHowever its possible that the device-type **thermostat** \nand device **thermostat1** might already exist.\n\nThat is the reason for providing the radio button \n***Ignore Exception if ... Exists***\n\nDepending upon the radio-button selection, either the exception would be ignored or an error would be flagged.\n","x":300.71429443359375,"y":138.11510467529297,"wires":[]},{"id":"1539ad74.1105cb","type":"function","z":"afc892bb.1a7a58","name":"fixup","func":"var fixup = msg.payload;\nfixup.d.temp = parseFloat(msg.payload.d.temp);\nfixup.d.humidity = parseFloat(msg.payload.d.humidity);\nmsg.payload = fixup;\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":380,"wires":[["5db3b2ac.baf21c","e04dedb0.f5c1c"]]},{"id":"5db3b2ac.baf21c","type":"debug","z":"afc892bb.1a7a58","name":"","active":false,"console":"false","complete":"false","x":970,"y":440,"wires":[]},{"id":"72ecec5c.3f1d0c","type":"Device Schema","z":"","deviceType":"thermostat","props":[{"guid":"724eb78fb0f0","name":"temp","random":{"func":"floating","args":{"min":20,"max":30,"fixed":1}}},{"guid":"0b54b74c334d","name":"humidity","random":{"func":"floating","args":{"min":50,"max":75,"fixed":1}}},{"guid":"8295712b564e","name":"location","defaultValue":{"type":"json","value":"{\"longitude\" : 77.609342, \"latitude\" : 12.901377}"}}],"evts":[{"guid":"27c1bb4a69ea","name":"stat","payload":{"properties":{"0":"724eb78fb0f0","1":"0b54b74c334d","2":"8295712b564e","length":3,"prevObject":{"0":"724eb78fb0f0","1":"0b54b74c334d","2":"8295712b564e","length":3,"prevObject":{"0":{},"1":{},"2":{},"length":3,"prevObject":{"0":{"sizzle1480596884727":{"parentNode":[3287,43,true]}},"selector":".red-ui-editableList-item-content","context":{},"length":1},"context":{},"selector":".red-ui-editableList-item-content .node-input-evts-payload option:selected"},"context":{}},"context":{}}}}]}]
